import 'package:carros_app/domain/carro.dart';import 'package:carros_app/domain/db/carro_db.dart';import 'package:carros_app/domain/services/carro_service.dart';import 'package:flutter/material.dart';class CarroPage extends StatefulWidget {  final Carro carro;  const CarroPage(this.carro);  @override  _CarroPageState createState() => _CarroPageState();}class _CarroPageState extends State<CarroPage> {  get carro => widget.carro;  bool _isFavorito = false;  @override  void initState() {    super.initState();    CarroDB.getInstance().exists(carro).then((bool) {      setState(() {        _isFavorito = bool;      });    });  }  @override  Widget build(BuildContext context) {    return Scaffold(      appBar: AppBar(        title: Text(carro.nome),        actions: <Widget>[          IconButton(icon: Icon(Icons.place), onPressed: () {}),          IconButton(icon: Icon(Icons.videocam), onPressed: () {}),          PopupMenuButton<String>(            onSelected: (string) {},            itemBuilder: (BuildContext context) {              return [                PopupMenuItem(                  child: Text("Editar"),                ),                PopupMenuItem(                  child: Text("Deletar"),                ),                PopupMenuItem(                  child: Text("Share"),                ),              ];            },          ),        ],      ),      body: _body(),    );  }  _body() {    return ListView(      padding: EdgeInsets.all(16),      children: <Widget>[        Image.network(carro.urlFoto),        _block1(),        SizedBox(height: 16,),        _block2(),      ],    );  }  Row _block1() {    return Row(      children: <Widget>[        Expanded(            child: Column(          crossAxisAlignment: CrossAxisAlignment.start,          children: <Widget>[            Text(              carro.nome,              style: TextStyle(fontSize: 22, fontWeight: FontWeight.bold),            ),            Text(              carro.tipo,              style: TextStyle(fontSize: 16, color: Colors.grey[500]),            ),          ],        )),        InkWell(            onTap: () {              _onClickFavorite(context, carro);            },            child: Icon(              Icons.favorite,              color: _isFavorito ? Colors.red : Colors.grey,              size: 36,            )),        InkWell(          onTap: () {},          child: Icon(            Icons.share,            size: 36,          ),        ),      ],    );  }  _block2() {    return Card(      elevation: 8,      child: Container(        padding: EdgeInsets.all(16),        child: Column(          crossAxisAlignment: CrossAxisAlignment.start,          children: <Widget>[            Text(              carro.desc,              style: TextStyle(fontSize: 22, fontWeight: FontWeight.bold),            ),            SizedBox(              height: 10,            ),            FutureBuilder<String>(              future: CarroService.getLoremIpsum(),              builder: (context, snapshot) {                return snapshot.hasData                    ? Text(snapshot.data)                    : CircularProgressIndicator();              },            ),          ],        ),      ),    );  }  void _onClickFavorite(BuildContext context, Carro carro) async {    final db = CarroDB.getInstance();    final exists = await db.exists(carro);    if(exists) {      db.deleteCarro(carro.id);    }    else {      int id = await db.saveCarro(carro);      print("Carro salvo: $id");    }    setState(() {      _isFavorito = !exists;    });  }}